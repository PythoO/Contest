{% extends "admin/layout.html" %}

{% block title %}Roles{%endblock%}

{% block body %}
<h2>Roles</h2>
<div>
    <a href="{{url_for('role_api')}}" class="btn btn-success">Add New Role</a>
    <form id=role_form" action="{% if role %}{{url_for('role_api', role_id=role.id)}}{% endif %}" method="post" role="form" class="form-horizontal">
    <div class="form-group">
        <label class="col-sm-2 control-label">Role Name :</label>
        <div class="col-sm-10">
            <input type="text" name="name" class="form-control" value="{% if role %}{{ role.name }}{% else %}ROLE_{% endif %}" placeholder="ROLE_" />
        </div>
    </div>

    <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
            <button class="btn btn-primary">Submit</button>
        </div>
    </div>
</form>
</div>
<div class="table-responsive">
    <table class="table table-striped">
        <thead>
        <tr>
            <th>#</th>
            <th>Title</th>
            <th>Modify</th>
            <th>Delete</th>
        </tr>
        </thead>
        <tbody>
        {% for role in roles %}
        <tr>
            <td>{{ role.id }}</td>
            <td>{{ role.name }}</td>
            <td><a href="{{url_for('role_api', role_id=role.id)}}" class="btn btn-primary">Modify</a></td>
            <td>
                <form class="role_delete" action="{{ url_for('role_api', role_id=role.id) }}">
                    <input type="submit" class="btn btn-warning" onclick="return confirm('Are you sure !!');" value="Delete">
                </form>

            </td>
        </tr>
        {% endfor %}
        </tbody>
        <tfoot></tfoot>
    </table>
</div>
{% endblock %}

{% block javascript %}
<script type="text/javascript">
jQuery(document).ready(function ($) {
    $("#role_form").submit(function(e){
        e.preventDefault();
        var form = $(this).serializeArray();
        var url = $(this).attr("action");
        $.ajax({
            data: form,
            url: url,
            type:"POST",
            success:function(response){
            }
        });
    });

    $(".role_delete").click(function(e){
        console.log($(this))
        e.preventDefault();
        var url = $(this).attr("action");
        $.ajax({
            url: url,
            type:"DELETE",
            success:function(response){
                window.location = '{{ url_for('role_api') }}'
            }
        });
    });
});
</script>
{% endblock %}